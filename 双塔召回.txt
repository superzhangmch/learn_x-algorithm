- user tower å’Œ scorer çš„model ç»“æ„ä¸€æ ·çš„ transforer æœºæ„. é‚£ä¹Ÿå°±æ˜¯è¯´, user-emb ç­‰çš„emb çš„æ–¹å¼ä¹Ÿæ˜¯ä¸€æ ·çš„å§.
- candidate tower æ˜¯ MLP: ä¹ƒåœ¨ post emb ä¸ author emb åŸºç¡€ä¸Šåš MLP

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚        â”‚        User Tower        â”‚       Candidate Tower       â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ ç»“æ„   â”‚ Transformer              â”‚ 2å±‚ MLP                     â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ è¾“å…¥   â”‚ user + history + actions â”‚ post + author               â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ å¤æ‚åº¦ â”‚ é«˜                       â”‚ ä½                          â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ è¾“å‡º   â”‚ [B, D]                   â”‚ [B, C, D] æˆ–ç¦»çº¿ç®—å¥½ [N, D] â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚      User Tower         â”‚          â”‚    Candidate Tower      â”‚
  â”‚                         â”‚          â”‚                         â”‚
  â”‚  User + History         â”‚          â”‚   Post + Author         â”‚
  â”‚         â†“               â”‚          â”‚         â†“               â”‚
  â”‚    Transformer          â”‚          â”‚    2å±‚ MLP              â”‚
  â”‚         â†“               â”‚          â”‚         â†“               â”‚
  â”‚   Mean Pool + L2 Norm   â”‚          â”‚      L2 Norm            â”‚
  â”‚         â†“               â”‚          â”‚         â†“               â”‚
  â”‚      [B, 128]           â”‚          â”‚     [N, 128]            â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚                                    â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ dot product â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â†“
                        scores [B, N]
                                â†“
                            top_k
                                â†“
                        å¬å›ç»“æœ [B, K]

  Candidate Tower å¾ˆè½»é‡ï¼Œå¯ä»¥ç¦»çº¿é¢„è®¡ç®—æ‰€æœ‰å€™é€‰çš„ embedding å­˜èµ·æ¥ã€‚


-----

  Embeddings è·å–æµç¨‹

  ğŸ“Š æ•´ä½“æ¶æ„

  # ä¸¤é˜¶æ®µæµç¨‹( è¿™æ˜¯ LLM è¯´çš„å¯èƒ½æ˜¯è¿™æ ·, å®é™…ä¸å¯ä»ä»£ç ä¸­æ¨æ–­)
  ID/Hash â†’ Embedding Lookup â†’ Model Input

  ä¾‹å­:
  user_id=123456789 â†’ hashå‡½æ•° â†’ [hash1, hash2] â†’ æŸ¥è¡¨ â†’ [emb1, emb2] â†’ èåˆ â†’ user_embedding

<<<=== ç–‘é—®
[Q] è¿™æ ·çš„è¯, æ–°ç”¨æˆ·ä¹Ÿèƒ½æœ‰ embedding, ä½†æ˜¯ä¸€èˆ¬user_id æ˜¯éšæœºçš„, è¿™æ ·ä¸€ä¸ªéšæœºç”¨æˆ·è¿™æ ·æå‡ºçš„ embedding, é è°±å—
[A] è¿™æ ·çš„ use-embedding ç¡®å®ä¸é è°±, ä½†æ˜¯ user-tower åˆ†æ”¯, user-embeddingåªå ä¸€å°éƒ¨åˆ†, æ›´å¤šæ¥è‡ªç”¨æˆ·è¡Œä¸º. ä½†æ€»ä¹‹, æ–°ç”¨æˆ·ä»ç„¶ç”¨: 
      user_id => hash(user_id)â†’[h1, h2] => lookupâ†’[emb1, emb2] => concat+projectionâ†’user_embedding (è¿™å« hash embedding, https://arxiv.org/abs/1709.03933 )

[Q] ç”¨æˆ·çš„id, æœ¬è´¨ä¸Šæ˜¯éšæœºçš„, åªè¦å¯¹ä¸€ä¸ªäºº, æ˜¯å›ºå®šçš„. è¿™ä¸ªæ•°å­—æ²¡å«ä¹‰. é€šè¿‡: user_id => hash(user_id)â†’[h1, h2] => lookupâ†’[emb1, emb2] => concat+projectionâ†’user_embedding, å°±æŠŠåŒä¸€ä¸ªh1æˆ–h2çš„ç”¨æˆ·å¼ºè¡Œå½“ä½œä¸€ç±»ç”¨æˆ·, è¿™ä¸ªåˆç†å—? æ„Ÿè§‰å°±åƒæ˜¯æŠŠä¸€ç±»ç”¨æˆ·ç»™å¼ºè¡Œåˆ†ä¸€ç»„
[A] ä¸ºä»€ä¹ˆå·¥ä¸šç•Œè¿˜æ•¢è¿™ä¹ˆå¹²ï¼Ÿå› ä¸ºä»–ä»¬é»˜è®¤äº†ä¸€ä¸ªéå¸¸é‡è¦ã€ä½†ç»å¸¸ä¸æ˜è¯´çš„å‰æï¼šuser_id æœ¬èº«ä¸æºå¸¦è¯­ä¹‰ï¼Œåªæ˜¯ä¸€ä¸ªâ€œç´¢å¼•â€. ç”¨æˆ·çš„â€œå…´è¶£ / åå¥½ / è¡Œä¸ºæ¨¡å¼â€, ä¸æ˜¯å­˜åœ¨ user_id é‡Œ, è€Œæ˜¯å­˜åœ¨äºï¼šå†å²è¡Œä¸ºåºåˆ—/ä¸Šä¸‹æ–‡/item embedding/feature crosses/attention / pooling çš„ç»“æœ. åœ¨è¿™ç§å‰æä¸‹ï¼Œuser_id embedding çš„ä½œç”¨é€€åŒ–ä¸ºï¼šä¸€ä¸ªâ€œå¯å­¦ä¹ çš„ç”¨æˆ·åç½®é¡¹ / residual / memory slotâ€
è´¨ç–‘æ˜¯å¯¹çš„, ä½†è¿™æ­£æ˜¯è®¾è®¡çš„ç²¾å¦™ä¹‹å¤„ï¼š                            
  âœ… User ID æœ¬æ¥å°±ä¸åº”è¯¥æœ‰å¼ºåŒºåˆ†èƒ½åŠ›
  - æ¨èåŸºäºè¡Œä¸ºï¼Œä¸æ˜¯åŸºäºèº«ä»½                                             
  âœ… "å¼ºè¡Œåˆ†ç»„"æ˜¯ä¸€ç§æ­£åˆ™åŒ–æŠ€æœ¯
  - é˜²æ­¢è¿‡æ‹Ÿåˆ
  - å¢å¼ºæ³›åŒ–èƒ½åŠ›                         
  - å‡å°‘å†…å­˜
  âœ… çœŸæ­£çš„ä¸ªæ€§åŒ–æ¥è‡ªå†å²è¡Œä¸º
  - History embeddings (97%) â† çœŸæ­£æœ‰æ„ä¹‰
  - User ID embeddings (3%) â† åªæ˜¯è¾…åŠ©
  âœ… è¿™æ˜¯å·¥ç¨‹å’Œæ•ˆæœçš„å¹³è¡¡
  # ç†æƒ³æ–¹æ¡ˆï¼ˆä¸å¯è¡Œï¼‰             
  æ¯ä¸ªç”¨æˆ·ç‹¬ç«‹ embedding â†’ 512 GB å†…å­˜ + è¿‡æ‹Ÿåˆ
  # å®é™…æ–¹æ¡ˆï¼ˆå¯è¡Œä¸”æœ‰æ•ˆï¼‰                  
  Hash-based embedding â†’ 50 MB å†…å­˜ + æ³›åŒ–å¥½
  # Trade-off:
  ç‰ºç‰²äº† user_id çš„åŒºåˆ†èƒ½åŠ›                         
  æ¢å–äº† å†…å­˜æ•ˆç‡ + æ³›åŒ–èƒ½åŠ› + å†·å¯åŠ¨
>>>

  ---
  1ï¸âƒ£ User Embeddings - Hash-based Lookup

  ä»£ç ä½ç½®: runners.py:421-423 + recsys_model.py:79-119

  æ­¥éª¤ 1: ç”Ÿæˆ Hash å€¼

  # runners.py:421-423
  user_hashes = rng.integers(
      1, num_user_embeddings,  # 1 åˆ° 100000
      size=(batch_size, num_user_hashes)  # [B, 2]
  ).astype(np.int32)

  # ç¤ºä¾‹è¾“å‡º:
  user_hashes = [
      [12345, 67890],  # User 0 çš„2ä¸ªhashå€¼
      [11111, 22222],  # User 1 çš„2ä¸ªhashå€¼
  ]  # Shape: [2, 2]

  æ­¥éª¤ 2: Embedding Table Lookup

  # å‡è®¾æœ‰ä¸€ä¸ªå…¨å±€çš„ embedding table
  user_embedding_table = [
      [0.1, 0.2, ..., 0.8],  # embedding for hash=0 (padding)
      [0.3, 0.4, ..., 0.9],  # embedding for hash=1
      ...
      [0.5, 0.6, ..., 0.7],  # embedding for hash=100000
  ]  # Shape: [100000, D]

  # æŸ¥è¡¨æ“ä½œ (è‡ªåŠ¨åœ¨è®­ç»ƒæ¡†æ¶ä¸­å®Œæˆ)
  user_embeddings = embedding_table[user_hashes]
  # Shape: [B, num_user_hashes, D] = [2, 2, 128]

  å®é™…ä»£ç ä¸­çš„ç¤ºä¾‹ï¼ˆrunners.py:472ï¼‰ï¼š
  embeddings = RecsysEmbeddings(
      user_embeddings=rng.normal(
          size=(batch_size, num_user_hashes, emb_size)
      ).astype(np.float32),
      # Shape: [B, 2, 128] - æ¯ä¸ªç”¨æˆ·æœ‰2ä¸ªhash embeddings
      ...
  )

  æ­¥éª¤ 3: èåˆå¤šä¸ª Hash Embeddings

  # recsys_model.py:79-119
  def block_user_reduce(user_hashes, user_embeddings, ...):
      """
      è¾“å…¥:
          user_embeddings: [B, num_user_hashes, D] = [B, 2, 128]

      å¤„ç†:
          1. Reshape: [B, 2, 128] â†’ [B, 1, 256]
          2. Linear projection: [B, 1, 256] â†’ [B, 1, 128]

      è¾“å‡º:
          user_embedding: [B, 1, D] = [B, 1, 128]
      """
      B, _, D = user_embeddings.shape

      # æ‹¼æ¥å¤šä¸ªhash embeddings
      user_embedding = user_embeddings.reshape((B, 1, num_user_hashes * D))
      # [B, 1, 2*128] = [B, 1, 256]

      # æŠ•å½±å› D ç»´
      proj_mat = get_parameter("proj_mat_1", [256, 128])
      user_embedding = Linear(D)(user_embedding)
      # [B, 1, 128]

      return user_embedding  # [B, 1, D]

  ---
  2ï¸âƒ£ Action Embeddings - Learnable Projection

  ä»£ç ä½ç½®: recsys_retrieval_model.py:161-184

  è¾“å…¥ï¼šMulti-hot Action Vector

  # runners.py:202-222 å®šä¹‰äº†19ç§è¡Œä¸ºç±»å‹
  ACTIONS = [
      "favorite_score",      # 0: ç‚¹èµ
      "reply_score",         # 1: å›å¤
      "repost_score",        # 2: è½¬å‘
      "photo_expand_score",  # 3: å±•å¼€å›¾ç‰‡
      "click_score",         # 4: ç‚¹å‡»è¯¦æƒ…
      ...
      "report_score",        # 17: ä¸¾æŠ¥
      "dwell_time",          # 18: åœç•™æ—¶é•¿
  ]  # æ€»å…± 19 ç§

  # ç”¨æˆ·çš„æŸæ¬¡å†å²è¡Œä¸º - Multi-hot vector
  history_actions[0, 5] = [1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
  #                        â†‘     â†‘
  #                     ç‚¹èµäº†  è½¬å‘äº†
  # Shape: [B, S, 19]

  Action Embedding ç”Ÿæˆ

  # recsys_retrieval_model.py:161-184
  def _get_action_embeddings(self, actions: jax.Array) -> jax.Array:
      """Convert multi-hot action vectors to embeddings.

      Args:
          actions: [B, S, num_actions] - multi-hot vectors
                   ä¾‹å¦‚: [B, 32, 19]

      Returns:
          action_emb: [B, S, D] - action embeddings
      """
      _, _, num_actions = actions.shape  # 19
      D = config.emb_size  # 128

      # å¯å­¦ä¹ çš„æŠ•å½±çŸ©é˜µ
      action_projection = get_parameter(
          "action_projection",
          [num_actions, D],  # [19, 128]
          init=VarianceScaling(1.0, mode="fan_out")
      )

      # å°† [0, 1] è½¬æ¢ä¸º [-1, 1]
      actions_signed = (2 * actions - 1).astype(jnp.float32)
      # [1, 0, 1, 0, ...] â†’ [1, -1, 1, -1, ...]

      # çŸ©é˜µä¹˜æ³•: [B, S, 19] @ [19, 128] â†’ [B, S, 128]
      action_emb = dot(actions_signed, action_projection)

      # æ©ç ï¼šå¦‚æœæ²¡æœ‰ä»»ä½•è¡Œä¸ºï¼Œåˆ™embeddingä¸º0
      valid_mask = any(actions, axis=-1, keepdims=True)
      action_emb = action_emb * valid_mask

      return action_emb  # [B, S, D]

  ---
  3ï¸âƒ£ Post & Author Embeddings - åŒæ ·æ˜¯ Hash Lookup

  # runners.py:425-438
  # Post hashes
  history_post_hashes = rng.integers(
      1, num_post_embeddings,  # 1 åˆ° 100000
      size=(batch_size, history_len, num_item_hashes)
  ).astype(np.int32)
  # Shape: [B, S, 2] - æ¯æ¡æ¨æ–‡ç”¨2ä¸ªhash

  # Author hashes
  history_author_hashes = rng.integers(
      1, num_author_embeddings,  # 1 åˆ° 100000
      size=(batch_size, history_len, num_author_hashes)
  ).astype(np.int32)
  # Shape: [B, S, 2] - æ¯ä¸ªä½œè€…ç”¨2ä¸ªhash

  # Embedding lookup (è‡ªåŠ¨å®Œæˆ)
  history_post_embeddings = post_embedding_table[history_post_hashes]
  # Shape: [B, S, 2, D] = [B, 32, 2, 128]

  history_author_embeddings = author_embedding_table[history_author_hashes]
  # Shape: [B, S, 2, D] = [B, 32, 2, 128]

  ---
  4ï¸âƒ£ Product Surface Embeddings - Lookup Table

  # recsys_retrieval_model.py:186-204
  def _single_hot_to_embeddings(self, input, vocab_size, emb_size, name):
      """Convert single-hot indices to embeddings via lookup table.

      Args:
          input: [B, S] - surface indices (0-15)
          vocab_size: 16 (ForYou, Following, Search, etc.)
          emb_size: 128

      Returns:
          embeddings: [B, S, D]
      """
      # åˆ›å»º embedding table
      embedding_table = get_parameter(
          name,
          [vocab_size, emb_size],  # [16, 128]
          init=VarianceScaling(1.0)
      )

      # One-hot + çŸ©é˜µä¹˜æ³• (ç­‰ä»·äºæŸ¥è¡¨)
      input_one_hot = one_hot(input, vocab_size)  # [B, S, 16]
      output = dot(input_one_hot, embedding_table)  # [B, S, 128]

      return output

  ---
  ğŸ“¦ å®Œæ•´çš„æ•°æ®æµ

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                   EMBEDDINGS ç”Ÿæˆæµç¨‹                            â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                                                                  â”‚
  â”‚  1. USER EMBEDDINGS                                              â”‚
  â”‚     user_id â†’ hashå‡½æ•° â†’ [h1, h2]                                â”‚
  â”‚                           â†“                                      â”‚
  â”‚                    Embedding Tables                              â”‚
  â”‚                    [100K, 128]                                   â”‚
  â”‚                           â†“                                      â”‚
  â”‚                    [emb1, emb2] â†’ Linear â†’ [user_emb]            â”‚
  â”‚                    [B, 2, 128]          â†’ [B, 1, 128]            â”‚
  â”‚                                                                  â”‚
  â”‚  2. POST EMBEDDINGS (å†å² & å€™é€‰)                                â”‚
  â”‚     post_id â†’ hashå‡½æ•° â†’ [h1, h2]                                â”‚
  â”‚                           â†“                                      â”‚
  â”‚                    Embedding Tables                              â”‚
  â”‚                    [100K, 128]                                   â”‚
  â”‚                           â†“                                      â”‚
  â”‚                    [emb1, emb2]                                  â”‚
  â”‚                    [B, S, 2, 128]                                â”‚
  â”‚                                                                  â”‚
  â”‚  3. AUTHOR EMBEDDINGS (å†å² & å€™é€‰)                              â”‚
  â”‚     author_id â†’ hashå‡½æ•° â†’ [h1, h2]                              â”‚
  â”‚                           â†“                                      â”‚
  â”‚                    Embedding Tables                              â”‚
  â”‚                    [100K, 128]                                   â”‚
  â”‚                           â†“                                      â”‚
  â”‚                    [emb1, emb2]                                  â”‚
  â”‚                    [B, S, 2, 128]                                â”‚
  â”‚                                                                  â”‚
  â”‚  4. ACTION EMBEDDINGS                                            â”‚
  â”‚     action_vector=[1,0,1,0,...]                                  â”‚
  â”‚     [B, S, 19]                                                   â”‚
  â”‚          â†“                                                       â”‚
  â”‚     Learnable Projection Matrix                                 â”‚
  â”‚     [19, 128]                                                    â”‚
  â”‚          â†“                                                       â”‚
  â”‚     [B, S, 128]                                                  â”‚
  â”‚                                                                  â”‚
  â”‚  5. PRODUCT SURFACE EMBEDDINGS                                   â”‚
  â”‚     surface_id (0-15)                                            â”‚
  â”‚     [B, S]                                                       â”‚
  â”‚          â†“                                                       â”‚
  â”‚     Embedding Table                                              â”‚
  â”‚     [16, 128]                                                    â”‚
  â”‚          â†“                                                       â”‚
  â”‚     [B, S, 128]                                                  â”‚
  â”‚                                                                  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  ---
  ğŸ”‘ å…³é”®ç‚¹

  1. Hash-based Embeddings çš„ä¼˜åŠ¿

  ä½¿ç”¨å¤šä¸ªå“ˆå¸Œå‡½æ•°ï¼ˆå¦‚ 2 ä¸ªï¼‰çš„åŸå› ï¼š
  - âœ… å‡å°‘ç¢°æ’: é™ä½ä¸åŒ ID æ˜ å°„åˆ°åŒä¸€ä¸ª embedding çš„æ¦‚ç‡
  - âœ… å‡å°‘å†…å­˜: ä¸éœ€è¦ä¸ºæ¯ä¸ª user/post/author éƒ½å­˜ä¸€ä¸ª embedding
  - âœ… æ³›åŒ–èƒ½åŠ›: æ–°ç”¨æˆ·/æ¨æ–‡å¯ä»¥ç«‹å³è·å¾— embedding

  2. Action Embeddings çš„ç‰¹æ®Šæ€§

  ä¸ºä»€ä¹ˆ action ä¸ç”¨ hashï¼Œè€Œç”¨æŠ•å½±çŸ©é˜µï¼Ÿ
  - âœ… Action ç±»å‹æ˜¯å›ºå®šä¸”æœ‰é™çš„ï¼ˆåªæœ‰19ç§ï¼‰
  - âœ… Multi-hot vector å¯ä»¥è¡¨è¾¾å¤šä¸ªåŒæ—¶å‘ç”Ÿçš„è¡Œä¸º
  - âœ… Signed projection (2*x-1) å¯ä»¥åŒºåˆ†"æœ‰"å’Œ"æ— "

  3. Embedding ç»´åº¦

  user_hashes:   [B, 2]      â†’ user_embeddings:   [B, 2, 128] â†’ [B, 1, 128]
  post_hashes:   [B, S, 2]   â†’ post_embeddings:   [B, S, 2, 128]
  author_hashes: [B, S, 2]   â†’ author_embeddings: [B, S, 2, 128]
  actions:       [B, S, 19]  â†’ action_embeddings: [B, S, 128]
  surface:       [B, S]      â†’ surface_embeddings:[B, S, 128]

  è¿™å°±æ˜¯æ‰€æœ‰ embeddings çš„ç”Ÿæˆæ–¹å¼ï¼æ ¸å¿ƒæ˜¯ Hash Lookup + Learnable Projectionã€‚
